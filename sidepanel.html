<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contextual Agent</title>
    <style>
      :root{ --bg1:#f6f8fb; --panel:#ffffff; --muted:#6b7280; --accent:#2563eb; --chip-bg:#f1f5f9 }
  html, body { height:100%; }
  body{ margin:0; padding:12px; box-sizing:border-box; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; background:var(--bg1); color:#0f1724; width:100%; max-width:420px; display:flex; flex-direction:column; }

      /* removed hero card - compact header space */
      .actions-row{ display:flex; gap:8px; margin-bottom:10px }
      .pill{ background:#fff; color:#0f1724; border:1px solid #e6eefb; padding:8px 10px; border-radius:8px; cursor:pointer; font-weight:600; box-shadow: 0 1px 2px rgba(16,24,40,0.04) }

      #context-area{ margin-bottom:12px }
      #context-chips{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:8px }
      .chip{ background:var(--chip-bg); color:#0b1220; padding:6px 10px; border-radius:999px; font-size:13px; display:inline-flex; align-items:center; gap:8px; border:1px solid rgba(16,24,40,0.04) }
      .chip button{ background:transparent; border:none; color:#0f1724; cursor:pointer; font-weight:700 }

      /* tabs dropdown */
      #tabs-dropdown{ display:none; max-height:220px; overflow:auto; background:#fff; border-radius:8px; border:1px solid #eef3fb; padding:6px }
      #tabs-dropdown .item{ padding:8px; border-radius:6px; color:#0f1724; cursor:pointer; font-size:13px; border-bottom:1px solid #f6f8fb }
      #tabs-dropdown .item:hover{ background: #f8fbff }
      #tabs-dropdown .search{ display:flex; gap:8px; padding:6px }
      #tabs-dropdown input[type="search"]{ width:100%; padding:8px; border-radius:8px; border:1px solid #eef3fb; background:transparent; color:inherit }

  /* toast notification */
  #toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:84px; background:#0b1220; color:#fff; padding:8px 12px; border-radius:8px; opacity:0; pointer-events:none; transition:opacity 240ms, transform 240ms; z-index:9999 }
  #toast.visible{ opacity:1; transform:translateX(-50%) translateY(-6px); pointer-events:auto }
  .primary-btn{ background:var(--accent); color:#fff; border:none; padding:8px 12px; border-radius:8px; font-weight:700 }
  .muted-btn{ background:transparent; color:var(--muted); border:1px solid #eef3fb; padding:6px 8px; border-radius:8px }

      /* status */
      #status{ font-size:12px; color:var(--muted); margin-top:6px }

  /* bottom panel that holds controls, contexts and chat input */
  .content{ flex:1; overflow:auto; }
  .bottom-panel{ background: linear-gradient(180deg, transparent, var(--bg1)); padding-top:10px; padding-bottom:8px; flex-shrink:0; }
  .controls-row{ display:flex; gap:8px; align-items:center; margin-bottom:6px }
  .controls-row label{ font-size:13px; color:#0f1724 }
  .controls-row input[type=checkbox]{ width:18px; height:18px }
  #clear-contexts{ background:#fff; border:1px solid #eef3fb; padding:6px 8px; border-radius:8px; cursor:pointer }

  /* chat input (inside bottom panel) */
  .chat-input{ display:flex; gap:8px; align-items:flex-end }
      .chat-input .left-meta{ display:flex; align-items:center }
      .site-chip{ background:transparent; color:var(--muted); border-radius:8px; padding:6px 8px; border:1px solid #eef3fb; font-size:12px }
      textarea#prompt-input{ width:100%; min-height:56px; max-height:180px; padding:10px; border-radius:10px; resize:vertical; border:1px solid #eef3fb; background:#fff; color:inherit; box-shadow: 0 1px 2px rgba(16,24,40,0.04) }
      textarea::placeholder{ color: #8b95a6 }
      .right-controls .send{ background:var(--accent); color:#fff; border:none; border-radius:10px; padding:10px 12px; cursor:pointer; font-weight:700; min-width:44px; height:44px; display:inline-flex; align-items:center; justify-content:center }
      .right-controls .send:hover{ filter:brightness(0.97) }

      /* responsive tweaks */
      @media (max-width:420px){ body{ padding:10px } .pill{ padding:6px 8px; font-size:13px } textarea#prompt-input{ min-height:48px } }
    </style>
  </head>
    <body>
    <div class="content">
      <!-- main content area left intentionally minimal; controls moved to bottom panel -->
      <div id="status" class="status"></div>
    </div>

    <div class="bottom-panel">
      <div class="controls-row">
        <button id="clear-contexts">Clear</button>
      </div>
      <div id="context-area">
        <div id="context-chips" aria-live="polite"></div>
        <div id="tabs-dropdown"></div>
      </div>
      <div class="chat-input">
        <div class="left-meta">
          <div class="site-chip" id="site-chip">Site</div>
        </div>
        <textarea id="prompt-input" placeholder="Ask a question about this page..."></textarea>
        <div class="right-controls">
          <button id="process-button" class="send" title="Send">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M2 21L23 12L2 3L2 10L17 12L2 14L2 21Z" fill="currentColor" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div id="toast" role="status" aria-live="polite"></div>

    <script src="sidepanel.js"></script>
  </body>
</html>
